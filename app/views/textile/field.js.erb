<% field_row = render partial: 'textile/field', locals: { index: @index } %>
<% add_field_button = link_to 'Add field', field_path(index: @index + 1), class: 'btn', data: { behavior: 'add-field' }, remote: true %>

$('[data-behavior~=add-field]').remove()
$('[data-behavior~=textile-form-body]').append('<%= escape_javascript(field_row) %>')
$('[data-behavior~=textile-form-footer]').find('td').append('<%= escape_javascript(add_field_button) %>')

$('[data-behavior~=delete-field]').click(function(){
  $(this).closest('[data-behavior~=textile-form-field]').remove()
});

$('[data-expand~=auto]').each( function() {
  $(this).css({'padding': '0.375rem 0.75rem', 'height': this.scrollHeight});
});
$('[data-expand~=auto]').on('keyup', function(e) {
  $(this).css({
    'padding': '0.375rem 0.75rem',
    'height': '1px'
  }).css({
    'padding': '0.375rem 0.75rem',
    'height': this.scrollHeight + 3
  });
});
